<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JC CNC Machine | Shop</title>

<style>
body{margin:0;font-family:Arial,sans-serif;background:#fff}
header{background:#b30000;color:#fff;padding:16px}
.wrap{max-width:1200px;margin:auto}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:20px}
.card{background:#000;color:#fff;border-radius:14px;padding:16px}
.card img{width:100%;height:180px;object-fit:cover;border-radius:10px}
.btn{background:#b30000;color:#fff;border:none;padding:10px 14px;border-radius:10px;cursor:pointer}
input,textarea{width:100%;padding:8px;margin-top:6px}
#cart{position:fixed;right:0;top:0;width:360px;height:100%;background:#fff;padding:16px;overflow:auto;display:none}
</style>
</head>

<body>

<header>
  <div class="wrap">
    <h2>JC CNC Machine</h2>
  </div>
</header>

<div class="wrap">
  <h3>Shop</h3>

  <button class="btn" onclick="filterCat('ALL')">All</button>
  <button class="btn" onclick="filterCat('CNC')">CNC</button>
  <button class="btn" onclick="filterCat('3D')">3D</button>

  <div class="grid" id="products"></div>
</div>

<!-- CART / CHECKOUT -->
<div id="cart">
  <h3>Checkout</h3>

  <form action="https://formspree.io/f/xpqazkbv" method="POST" onsubmit="prepareOrder()">
    <input name="name" placeholder="Full Name" required>
    <input name="email" type="email" placeholder="Email" required>
    <textarea name="address" placeholder="Shipping Address" required></textarea>

    <input type="hidden" name="order" id="orderField">
    <input type="hidden" name="total" id="totalField">

    <div id="cartItems"></div>

    <h4 id="totalText"></h4>

    <button class="btn" type="submit">Submit Order</button>
  </form>
</div>

<script>
const PRODUCTS=[
  {id:"srt4",name:"SRT-4",category:"3D",price:25,available:true,img:"srt-1.png"},
  {id:"adapter",name:"CNC Adapter",category:"CNC",price:95,available:false,img:"adapter.jpg"},
  {id:"jig",name:"3D Assembly Jig",category:"3D",price:45,available:true,img:"jig.jpg"}
];

let CAT="ALL";
let CART=[];

function filterCat(c){CAT=c;render();}

function render(){
  const el=document.getElementById("products");
  el.innerHTML=PRODUCTS
    .filter(p=>p.available)
    .filter(p=>CAT==="ALL"||p.category===CAT)
    .map(p=>`
      <div class="card">
        <img src="${p.img}">
        <h4>${p.name}</h4>
        <p>$${p.price}</p>
        Qty <input type="number" min="1" value="1" id="q-${p.id}">
        <button class="btn" onclick="add('${p.id}')">Add</button>
      </div>
    `).join("");
}

function add(id){
  const p=PRODUCTS.find(x=>x.id===id);
  const q=parseInt(document.getElementById(`q-${id}`).value);
  const f=CART.find(x=>x.id===id);
  f?f.qty+=q:CART.push({...p,qty:q});
  document.getElementById("cart").style.display="block";
  renderCart();
}

function renderCart(){
  let t=0;
  const el=document.getElementById("cartItems");
  el.innerHTML="";
  CART.forEach(p=>{
    t+=p.qty*p.price;
    el.innerHTML+=`${p.name} x ${p.qty} = $${p.qty*p.price}<br>`;
  });
  document.getElementById("totalText").innerText="Total: $"+t;
}

function prepareOrder(){
  let summary="";
  let t=0;
  CART.forEach(p=>{
    summary+=`${p.name} x ${p.qty} = $${p.qty*p.price}\n`;
    t+=p.qty*p.price;
  });
  document.getElementById("orderField").value=summary;
  document.getElementById("totalField").value="$"+t;
}

render();
</script>

</body>
</html>
